
<!DOCTYPE html>
<html>
<head>
    <title>Bot Integration</title>
    <script src="https://cdn.botframework.com/botframework-webchat/latest/webchat.js"></script>
    <script src="https://alcdn.msauth.net/browser/2.14.2/js/msal-browser.min.js"></script>
    <style>
        html, body {
            height: 100%;
            margin: 0;
        }

        #webchat {
            height: 100%;
            width: 100%;
        }
    </style>
</head>
<body>
    <div id="webchat"></div>
    <script>
        // MSAL.js configuration
        const msalConfig = {
            auth: {
                clientId: 'ab25b55d-6b5e-443e-8bc1-d14168c680e0', // Replace with your Azure AD client ID
                authority: 'https://login.microsoftonline.com/b209e2b2-a1f7-44ea-94c5-3c09c252e151', // Replace with your Azure AD tenant ID
                redirectUri: window.location.href
            }
        };

        const msalInstance = new msal.PublicClientApplication(msalConfig);

        const loginRequest = {
            scopes: ['user.read']
        };

        msalInstance.loginPopup(loginRequest).then(loginResponse => {
            // Get account information
            const account = msalInstance.getAllAccounts()[0];

            // Fetch user profile information
            msalInstance.acquireTokenSilent(loginRequest).then(tokenResponse => {
                const userID = account.localAccountId;
                const username = account.username;

                // Replace with your Direct Line secret
                const directLineSecret = 'ce3jXTNpfyI.Y80Y91UXiGEEaSV3tEm64kUCijvkvVXgxE38xntiGZ8';

                window.WebChat.renderWebChat({
                    directLine: window.WebChat.createDirectLine({
                        secret: directLineSecret
                    }),
                    userID: userID,
                    username: username,
                    locale: 'en-US'
                }, document.getElementById('webchat'));
            }).catch(error => {
                console.error(error);
            });
        }).catch(error => {
            console.error(error);
        });
    </script>
</body>
</html>
